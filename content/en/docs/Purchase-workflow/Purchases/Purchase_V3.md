---
title: "Create a Purchase"
linkTitle: "Create a Purchase"
date: 2024-08-22T11:40:29-05:00
Description: >
  Create a purchase using the API flow providing its basic information for PCI and Non-PCI Merchants.
weight: 20
tags: ["subtopic"]
---

## Create a Purchase
After successfully [tokenizing a card]({{< ref "customer-types.md" >}}), you can proceed with generating a purchase using this method. The Purchase API is specifically designed for merchants who do not have PCI DSS certification, allowing them to process payments securely without handling sensitive card data directly.

For alternative payment methods such as cash payments or bank transfers, you only need to provide the corresponding payment method ID to initiate the transaction.


{{% alert title="Looking for previous API versions?" color="info"%}}
If you're searching for documentation on earlier API versions (V2), please refer to our [Legacy Systems section]({{< ref Purchase-Operations.md >}}#create-a-purchase)
{{% /alert %}}

### Request URL
You must invoke a **POST** request to the following URLs according to your needs.

* **Production**: `https://api.bamboopayment.com/v3/api/purchase`
* **Stage**: `https://api.stage.bamboopayment.com/v3/api/purchase`

<br />

> Remember to include your **merchant's Private Key** in the request headers. <br /> For more details, check our [Authentication Guide]({{< ref "Authentication.md" >}}).

### Request parameters

| Parameter | Type | Mandatory? | Description |
|-----------|------|:----------:|-------------|
| `TrxToken` | `string` | No<sup>1</sup> | Card token, previously generated through the tokenization flow. Used for card payment methods. |
| `NetworkToken` | `object` | No<sup>1</sup> | Network token information used in the transaction. For more information, review the Network Tokenization Object. |
| `PaymentMethod` | `string` | No<sup>1</sup> | Payment method identifier. Used only for alternative payment methods (transfer, cash, etc.) Find the possible values ​​in the table [Payment methods](/en/docs/getting-started/payment-methods.html).|
| `UniqueID` | `string` | No | Unique identifier of the purchase.<br>This optional value allows you to identify a unique purchase and avoid duplication of transactions in case of communication errors. For more information, refer to [Concepts]({{< ref "Concepts.md">}}#UniqueID). |
| `Capture` | `boolean` | No | Defines whether the purchase should be performed in one or two steps.<sup>2</sup><br><ul style="margin-bottom: initial;"><li>If `false`, only the authorization is processed, and the purchase is pre-authorized until the final confirmation through the [capture and cancel]({{< ref "Card_Operations.md" >}}) calls.</li><li>If `true`, the transaction is authorized and captured.</li></ul><br>All [payment methods and countries](/en/docs/payment-methods.html) may not support the pre-authorization feature. |
| `TargetCountryISO` | `string` | Yes | This parameter indicates the country where the payment will be processed.<br>Send the country using `ISO-3166-1` format. |
| `Currency` | `string` | Yes | Currency of the purchase, according to ISO-4217. Find the possible values in the Currencies table of [each country](/en/docs/payment-methods.html). |
| `Amount` | `integer` (64 bits) | Yes | Amount of the purchase. This value must be greater than zero.<br>If you must include decimals in the amount, concatenate the decimal places without the decimal point. Example `12,25` > `1225`. |
| `Tip` | `integer` (64 bits) | No | Tip amount in the transaction. Value with two decimals, without points or commas. |
| `TaxableAmount` | `integer` (64 bits) | No | Taxable amount of the transaction. Value with two decimals, without points or commas. |
| `Installments` | `integer` | No | Number of installments. |
| `Order` | `string` | Yes | Order number generated by the merchant. |
| `InvoiceNumber` | `string` | No | Invoice number associated with the transaction. |
| `Description` | `string` | No <sup>4</sup> | Optional description of the purchase. |
| `AdditionalData` | `string` | No | Additional information that may be relevant to the transaction. |
| `MetadataIn` | `object` | No | Additional transaction data in key-value format. |
| `Customer` | `object` | Yes <sup>3</sup> | The `Customer` object provides the data of the person who performs the purchase. |


#### Customer Object

| Parameter | Type | Mandatory? | Description |
|-----------|------|:----------:|-------------|
| `Customer` → `FirstName` | `string` | No | Customer's first name. |
| `Customer` → `LastName` | `string` | No | Customer's last name. |
| `Customer` → `ReferenceCode` | `string` | No | Reference code for the customer. |
| `Customer` → `PhoneNumber` | `string` | No | Customer's phone number. |
| `Customer` → `DocumentNumber` | `string` | No | Customer's document number. |
| `Customer` → `DocumentType` | `string` | No | Document type. (Format `DOCUMENT`.`COUNTRY`)  |
| `Customer` → `Email` | `string` | Yes | Customer's email address. |
| `Address` | `object` | No | Customer's shipping address. |

#### Address Object

| Parameter | Type | Mandatory? | Description |
|-----------|------|:----------:|-------------|
| `Address` → `Country` | `string` | No | Country of the customer address. |
| `Address` → `City` | `string` | No | City of the customer address. |
| `Address` → `State` | `string` | No | State or region of the customer address. |
| `Address` → `PostalCode` | `string` | No | Postal code of the customer address. |
| `Address` → `AddressDetail` | `string` | No | Additional details of the customer address. |


{{% alert title="Notes" color="info"%}}
* <sup>1</sup> The `PaymentMediaId` and `TrxToken` parameters are not required. Nevertheless, sending one of them is mandatory, depending on the flow you want to use.
* <sup>2</sup> All the payment methods may not support the pre-authorization feature. Review the [Countries and payment methods](/en/docs/payment-methods.html) section to check availability.
* <sup>3</sup> This object is not required if you create the purchase using [_CommerceToken_]({{< ref Registered-users.md >}}).
* <sup>4</sup> When using [cards in Brazil]({{< ref br-cards.md>}}), the description is mandatory and must use a fixed format, as explained in the [request parameters]({{< ref br-cards.md>}}#request-parameters).
* Keep in mind that for the Anti-fraud system's correct functioning, we suggest sending additional data described in the [Anti-fraud]({{< ref "Antifraud.md" >}}) section.
* For detailed information about [3D Secure - 3DS]({{< ref "3D_Secure.md" >}}) and [Network Token]({{< ref "Network_Tokens.md" >}}) objects, please refer to their corresponding sections in this documentation. **PaymentMethodId** is mandatory when sending a Network Token.


{{% /alert %}}

### Request example

{{< highlight json >}}
{{< Payins/V3/CreatePurchase/requestPurchase >}}
{{< /highlight >}} 

## Direct Purchase for PCI-Compliant Merchants
For merchants who have achieved PCI DSS compliance, Bamboo offers enhanced flexibility through the Direct Purchase method. This advanced option allows PCI-compliant merchants to handle card data directly within their secure environments.

{{% alert title="Looking for previous API versions?" color="info"%}}
If you're searching for documentation on earlier API versions (V2), please refer to our [Legacy Systems section]({{< ref direct-purchase.md >}})
{{% /alert %}}

### Request URL
You must invoke a **POST** request to the following URLs according to your needs.

* **Production**: `https://secure-api.bamboopayment.com/v3/api/purchase`
* **Stage**: `https://secure-api.stage.bamboopayment.com/v3/api/purchase`

<br />

> Remember to include your **merchant's Private Key** in the request headers. <br /> For more details, check our [Authentication Guide]({{< ref "Authentication.md" >}}).

### Request parameters

##### CardData Object

| Parameter | Type | Mandatory? | Description |
|---|---|:---:|---|
| `CardHolderName` | `string` | Yes | The name of the cardholder as it appears on the card. |
| `Pan` | `string` | Yes | The Primary Account Number (PAN) of the card. |
| `CVV` | `string` | Yes | The Card Verification Value (CVV) or Card Security Code. |
| `Expiration` | `string` | Yes | The expiration date of the card in the format "MM/YY". |
| `Email` | `string` | Yes | The email associated with the cardholder. |
| `Document` | `string` | No | The identification document number of the cardholder. |



{{% alert title="Info" color="info"%}}

**Note:** The CardData object should only be used for transactions with non-tokenized cards. Ensure that sensitive card data is handled securely and in compliance with PCI DSS standards.

{{% /alert %}}


### Request example 

{{< highlight json >}}
{{< Payins/V3/CreatePurchase/requestPurchase_DirectPurchase >}}
{{< /highlight >}} 

<br>

The fields **CardData**, **PaymentMethod**, **NetworkToken** and **TrxToken** are not required; Nevertheless, one of them must be send depending of which flow to use.

## Response
The response structure for Direct Purchase operations performed by PCI-compliant merchants is identical to the standard Purchase response. This ensures consistency across different transaction types and simplifies integration processes.

All fields, statuses, and error codes described in the standard Purchase response apply equally to Direct Purchase transactions.


| Parameter | Type | Description |
|---|---|---|
| `TransactionId` | `string` | Unique identifier for the transaction. A 19-digit number sent as a string for compatibility. |
| `Result` | `string` | Outcome of the transaction. `COMPLETED` or `ACTION_REQUIRED`. See the "Action" object for instructions. |
| `Status` | `string` | Current status of the transaction (e.g., Approved, Rejected). |
| `ErrorCode` | `string` | Error code if the transaction was rejected. |
| `ErrorDescription` | `string` | Detailed description of the error if the transaction was rejected. |
| `Created` | `string` | Timestamp of when the transaction was created, in **ISO 8601** format. |
| `AuthorizationDate` | `string` | Timestamp of when the transaction was authorized, in **ISO 8601** format. |
| `AuthorizationCode` | `string` | Unique code provided by the issuer to confirm the transaction authorization. |
| `Amount` | `integer` | Total transaction amount. |
| `Currency` | `string` | Currency code used for the transaction. May differ from the request currency based on business agreements. |
| `Installments` | `integer` | Number of payment installments for the transaction. |
| `TaxableAmount` | `integer` | Amount subject to taxes. |
| `Tip` | `integer` | Tip amount. |
| `Url` | `string` | Link to access additional transaction details. |
| `MetadataOut` | `object` | Additional metadata returned with the transaction response. |
| `Action` | `object` | Details of required actions when Result is "ACTION_REQUIRED". |
| `PaymentMethod` | `object` | Information about the payment method used for the transaction. |

#### Action Object

The Action object provides information about additional steps required to complete a transaction. It is typically present when the transaction result is **"ACTION_REQUIRED"**, indicating that further action is needed from the user or merchant to finalize the payment process.

| Parameter | Type | Description |
|---|---|---|
| `SessionId` | `string` | Session identifier related to the action. Informational value. |
| `Reason` | `string` | Reason for the requested action. Possible values:<br>• `VERIFICATION_CODE_NEEDED:` Transaction pending CVV, redirection to "URL" required to display CVV input form.<br>• `REDIRECTION_NEEDED_EXTERNAL_SERVICE`: Redirection to "URL" required to complete transaction details. |
| `URL` | `string` | Redirection URL to complete the required action. |

#### PaymentMethod Object

The PaymentMethod object contains detailed information about the payment method used in the transaction. This includes card details (for card transactions) or other relevant payment method information.

| Parameter | Type | Description |
|---|---|---|
| `Brand` | `string` | Brand of the card used (e.g., MasterCard, Visa). |
| `CardOwner` | `string` | Name of the cardholder. |
| `Bin` | `string` | First 6 digits of the card number. |
| `IssuerBank` | `string` | Issuing bank of the card. |
| `Type` | `string` | Type of payment method (e.g., CreditCard, DebitCard). |
| `Expiration` | `string` | Card expiration date in yyyymm format. |
| `Last4` | `string` | Last 4 digits of the card number. |

### Response examples
<br>


{{< tabs tabTotal="2" tabID="responses" tabName1="HTTP 200" tabName2="HTTP 400/409" >}}
{{< tab tabNum="1" >}}
<br>

**Result:**`COMPLETED` - **Status:** `APPROVED`

{{< highlight json >}}
{{< Payins/V3/CreatePurchase/http200_approved currency="BRL">}}
{{< /highlight >}} 
<br>

**Result:**`COMPLETED` - **Status:** `REJECTED`

{{< highlight json >}}
{{< Payins/V3/CreatePurchase/http200_rejected >}}
{{< /highlight >}} 

<br>

**Result:**`ACTION_REQUIRED` - **Status:** `PENDING`

{{< highlight json >}}
{{< Payins/V3/CreatePurchase/http200_pending >}}
{{< /highlight >}} 

{{< /tab >}}

{{< tab tabNum="2" >}}
<br>

{{< highlight json >}}
{{< Payins/V3/CreatePurchase/http400_409 >}}
{{< /highlight >}} 

{{< /tab >}}


{{< /tabs >}}
